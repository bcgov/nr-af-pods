var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,l,n,o,i){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof r[o]&&r[o],s=a.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(e,l){if(!s[e]){if(!t[e]){var n="function"==typeof r[o]&&r[o];if(!l&&n)return n(e,!0);if(a)return a(e,!0);if(d&&"string"==typeof e)return d(e);var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}f.resolve=function(l){var n=t[e][1][l];return null!=n?n:l},f.cache={};var c=s[e]=new u.Module(e);t[e][0].call(c.exports,f,c,c.exports,this)}return s[e].exports;function f(e){var t=f.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=t,u.cache=s,u.parent=a,u.register=function(e,l){t[e]=[function(e,t){t.exports=l},{}]},Object.defineProperty(u,"root",{get:function(){return r[o]}}),r[o]=u;for(var c=0;c<l.length;c++)u(l[c]);if(n){var f=u(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=f:"function"==typeof e&&e.amd?e(function(){return f}):i&&(this[i]=f)}}({eydOt:[function(e,t,l){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(l),n.export(l,"config",()=>i);var o=e("~constants/task-command");let i={matches:["https://af-pods-dev.powerappsportals.com/*","https://af-pods-test.powerappsportals.com/*"]};async function r(e){let t=new Event("change",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}window.addEventListener("load",()=>{window.opener&&(console.log("Sending READY_FOR_EXEC_TEST_STEPS to the PODS Test Manager browser tab (window opener) using postMessage..."),window.opener.postMessage(o.TEST_AGENT_READY_FOR_TEST_STEPS,"*"))}),window.addEventListener("message",e=>{console.log(`messages received by PODS Test Agent: event.data = ${e.data} | event.origin = ${e.origin}`);let t=e.data.indexOf('"action"')>-1;if(!t)return;let l=JSON.parse(e.data);l&&l?.length>0&&c(l)},!1);var a=null;async function s(){if(a)return a;let e=document.getElementsByTagName("label");a=new Map;for(let l=0;l<e.length;l++){let n=e[l];var t=a[n.textContent];if(t){let e=1;for(;t;){let l=`${n.textContent}_DisplayOrder${++e}`;(t=a[l])||(a[l]=n)}}else a[n.textContent]=n}return a}var d=null;async function u(){if(d)return d;d=[];let e=document.getElementsByTagName("table");if(e)for(let t=0;t<e.length;t++){let l={htmlTable:e[t],headerCells:[]},n=e[t].rows[0];for(let e=0;e<n.childNodes.length;e++){let t=n.childNodes[e],o=t.textContent.replace(". sort descending","").replace(". sort ascending","").trim();l.headerCells.push({name:o,index:e})}d.push(l)}return d}async function c(e){console.log(` Executing Test Steps...: ${JSON.stringify(e)}`);let t=await s(),l="";console.log(`Agent executing test steps. Test steps: ${JSON.stringify(e)}`);let n=!1,o=!1;for(let a of e){if(n)a.results=`CANCELLED due to the last FAILED step ___ Action: ${a.action}; ${a.description?a.description:""}`,a.failed=!0;else{let e=a.action.toLowerCase().trim(),s="noLabel";switch(a.field&&(s=a.field.displayOrder?`${a.field.label}_DisplayOrder${a.field.displayOrder}`:a.field.label),a.results="",e){case"find-list-item":let d=await u();if(!d||0==d.length){a.results+=`'${a.description}' step failed. No any lists/tables found on the page.`,n=!0;break}let c=d[0],f=!1;for(let e=1;e<c.htmlTable.rows.length;e++){let t=0;for(let l=0;l<a.fields.length;l++){let i=a.fields[l],r=c.headerCells.find(e=>e.name==i.label);if(!r){a.results+=`'${a.description}' step failed. Expected ${i.label} label not found in the header columns.`,n=!0;break}if(i.visible?c.htmlTable.rows[e].childNodes[r.index].textContent==i.value&&t++:t++,t==a.fields.length){if(f=!0,i.action?.toLocaleLowerCase()=="click the link"){let t=c.htmlTable.rows[e].childNodes[r.index];t.querySelector("a")?.click()}o=!0;break}}}f||(a.results+=`'${a.description}' step failed. Expected item not found in the list.`);break;case"expect":let p=t[s];if(p){let e=p.parentNode?.classList?.contains("required"),t=!0===a.field.required;e!==t&&(a.results+=`'${s}' field: Expected to be ${t?"REQUIRED":"OPTIONAL"}, but actually is ${e?"REQUIRED":"OPTIONAL"} `);let l="none"!==window.getComputedStyle(p.parentNode.parentNode.parentNode).display;if(l!==a.field.visible&&(a.results+=`'${s}' field: Expected to be ${a.field.visible?"VISIBLE":"HIDDEN"}, but actually is ${l?"VISIBLE":"HIDDEN"} `),Object.keys(a.field).indexOf("value")>-1){let e=a.field.value,t=null,l=p.id.replace("_label",""),n=document.getElementById(l),o=n.getAttribute("data-type");e!==(o||(o=n.getAttribute("type")),t="checkbox"===o?n.checked:n.value)&&(a.results+=`'${s}' field: Expected to to have the value ${e}, but it actually has ${t} `)}}else a.results+=`'${s}' field: Label Not Found.`;break;case"enter":let g=t[s];if(!g){a.results+=`Failed entering value in to the '${s}' field as the label Not Found.`;break}let h=g.id.replace("_label",""),b=document.getElementById(h),m=b.getAttribute("data-type");switch(m||(m=b.getAttribute("type")),m){case"date":let E=new Date(a.field.value).toISOString().replace(".000Z",".0000000Z");b.value=E;let T=document.getElementById(`${h}_datepicker_description`);T.value=a.field.value;break;case"checkbox":let y=a.field.value.toLocaleLowerCase();b.checked="checked"===y;break;default:b.value=a.field.value}r(b);break;case"select":let v=t[s];if(!v){a.results+=`Failed entering value in to the '${s}' field as the label Not Found.`;break}let w=v.id.replace("_label",""),_=document.getElementById(w),O=!1;if(_.options){for(let e of _.options)if(e.text.toLocaleLowerCase()===a.field.value.toLocaleLowerCase()){_.value=e.value,O=!0;break}}O?r(_):a.results+=`Failed selecting ${a.field.value} value for the '${s}' drop-down field as the specified value not found.`;break;default:let S=e.startsWith("click");if(S){let t=/the (?<elementname>\w+) button/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(console.log(l),0===l.length)return;let n=l[0][0];console.log(`buttonLabel: ${n}`);let i=document.getElementsByTagName("input");for(let e=0;e<i.length;e++){let t=i[e];t.value.toLowerCase()===n&&(t.click(),o=!0)}break}let $=e.startsWith("test step group");if($){l=a.action;break}let x=e.startsWith("enable");if(x){let t=/the (?<elementname>\w+) button/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(console.log(l),0===l.length)return;let n=l[0][0];console.log(`buttonLabel: ${n}`);let o=document.getElementsByTagName("input");for(let e=0;e<o.length;e++){let t=o[e];t.value.toLowerCase()===n&&(t.disabled=!1)}break}let N=e.startsWith("wait");if(N){let t=/for (?<elementname>\w+) seconds/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(0===l.length)return;let n=l[0][0];await i(+n)}}""!==a.results?(a.results=`\u26d4 STEP ${a.id} ${a.results} - ${l}`,a.failed=!0):(a.results=`\u2705 STEP ${a.id}: ${a.action} ${a.description?a.description:a.field?`${JSON.stringify(a.field)}`:""}`,a.failed=!1)}if(a.executed=!0,window.opener.postMessage(JSON.stringify(a),"*"),o)break}async function i(e){return new Promise(t=>setTimeout(t,e))}}},{"~constants/task-command":"3Fd9E","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3Fd9E":[function(e,t,l){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(l),n.export(l,"OPEN_NEW_TAB",()=>o),n.export(l,"GET_GITHUB_JSON_FILE_CONTENT",()=>i),n.export(l,"TEST_RESULT",()=>r),n.export(l,"TEST_AGENT_READY_FOR_TEST_STEPS",()=>a),n.export(l,"EXEC_TEST_STEPS",()=>s);let o="open-new-tab",i="get-file-content",r="test-result",a="TEST_AGENT_READY_FOR_TEST_STEPS",s="EXEC_TEST_STEPS"},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(e,t,l){l.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},l.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},l.exportAll=function(e,t){return Object.keys(e).forEach(function(l){"default"===l||"__esModule"===l||t.hasOwnProperty(l)||Object.defineProperty(t,l,{enumerable:!0,get:function(){return e[l]}})}),t},l.export=function(e,t,l){Object.defineProperty(e,t,{enumerable:!0,get:l})}},{}]},["eydOt"],"eydOt","parcelRequire7000"),globalThis.define=t;