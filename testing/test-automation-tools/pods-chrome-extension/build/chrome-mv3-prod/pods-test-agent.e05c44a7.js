var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,l,n,o,a){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof r[o]&&r[o],s=i.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(e,l){if(!s[e]){if(!t[e]){var n="function"==typeof r[o]&&r[o];if(!l&&n)return n(e,!0);if(i)return i(e,!0);if(d&&"string"==typeof e)return d(e);var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}c.resolve=function(l){var n=t[e][1][l];return null!=n?n:l},c.cache={};var f=s[e]=new u.Module(e);t[e][0].call(f.exports,c,f,f.exports,this)}return s[e].exports;function c(e){var t=c.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=t,u.cache=s,u.parent=i,u.register=function(e,l){t[e]=[function(e,t){t.exports=l},{}]},Object.defineProperty(u,"root",{get:function(){return r[o]}}),r[o]=u;for(var f=0;f<l.length;f++)u(l[f]);if(n){var c=u(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof e&&e.amd?e(function(){return c}):a&&(this[a]=c)}}({eydOt:[function(e,t,l){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(l),n.export(l,"config",()=>a);var o=e("~constants/task-command");let a={matches:["https://af-pods-dev.powerappsportals.com/*","https://af-pods-test.powerappsportals.com/*"]};async function r(e){let t=new Event("change",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}window.addEventListener("load",()=>{window.opener&&(console.log("Sending READY_FOR_EXEC_TEST_STEPS to the PODS Test Manager browser tab (window opener) using postMessage..."),window.opener.postMessage(o.TEST_AGENT_READY_FOR_TEST_STEPS,"*"))}),window.addEventListener("message",e=>{console.log(`messages received by PODS Test Agent: event.data = ${e.data} | event.origin = ${e.origin}`);let t=e.data.indexOf('"action"')>-1;if(!t)return;let l=JSON.parse(e.data);l&&l?.length>0&&f(l)},!1);var i=null;async function s(){if(i)return i;let e=document.getElementsByTagName("label");i=new Map;for(let l=0;l<e.length;l++){let n=e[l];var t=i[n.textContent];if(t){let e=1;for(;t;){let l=`${n.textContent}_DisplayOrder${++e}`;(t=i[l])||(i[l]=n)}}else i[n.textContent]=n}return i}var d=null;async function u(){if(d)return d;d=[];let e=document.getElementsByTagName("table");if(e)for(let t=0;t<e.length;t++){let l={htmlTable:e[t],headerCells:[]},n=e[t].rows[0];for(let e=0;e<n.childNodes.length;e++){let t=n.childNodes[e],o=t.textContent.replace(". sort descending","").replace(". sort ascending","").trim();l.headerCells.push({name:o,index:e})}d.push(l)}return d}async function f(e){console.log(` Executing Test Steps...: ${JSON.stringify(e)}`);let t=await s(),l="";console.log(`Agent executing test steps. Test steps: ${JSON.stringify(e)}`);let n=!1,o=!1;for(let i of e){if(n)i.results=`CANCELLED due to the last FAILED step ___ Action: ${i.action}; ${i.description?i.description:""}`,i.failed=!0;else{let e=i.action.toLowerCase().trim(),s="noLabel";switch(i.field&&(s=i.field.displayOrder?`${i.field.label}_DisplayOrder${i.field.displayOrder}`:i.field.label),i.results="",e){case"find-list-item":let d=await u();if(!d||0==d.length){i.results+=`'${i.description}' step failed. No any lists/tables found on the page.`,n=!0;break}let f=d[0],c=!1;for(let e=1;e<f.htmlTable.rows.length;e++){let t=0;for(let l=0;l<i.fields.length;l++){let a=i.fields[l],r=f.headerCells.find(e=>e.name==a.label);if(!r){i.results+=`'${i.description}' step failed. Expected ${a.label} label not found in the header columns.`,n=!0;break}if(a.visible?f.htmlTable.rows[e].childNodes[r.index].textContent==a.value&&t++:t++,t==i.fields.length){if(c=!0,a.action?.toLocaleLowerCase()=="click the link"){let t=f.htmlTable.rows[e].childNodes[r.index];t.querySelector("a")?.click()}o=!0;break}}}c||(i.results+=`'${i.description}' step failed. Expected item not found in the list.`);break;case"expect":if(i.button){console.log(`buttonLabel: ${i.button.label}`);let e=document.getElementsByTagName("input");for(let t=0;t<e.length;t++){let l=e[t];if(l.value.toLowerCase()===i.button.label.toLowerCase()){l.disabled!==i.button.disabled&&(i.results+=`'${i.button.label}' button: Expected to be ${i.button.disabled?"DISABLED":"ENABLED"}, but actually is ${l.disabled?"DISABLED":"ENABLED"} `);break}}break}let p=t[s];if(p){let e=p.parentNode?.classList?.contains("required"),t=!0===i.field.required;e!==t&&(i.results+=`'${s}' field: Expected to be ${t?"REQUIRED":"OPTIONAL"}, but actually is ${e?"REQUIRED":"OPTIONAL"} `);let l="none"!==window.getComputedStyle(p.parentNode.parentNode.parentNode).display;l!==i.field.visible&&(i.results+=`'${s}' field: Expected to be ${i.field.visible?"VISIBLE":"HIDDEN"}, but actually is ${l?"VISIBLE":"HIDDEN"} `)}else i.results+=`'${s}' field: Label Not Found.`;break;case"enter":let b=t[s];if(!b){i.results+=`Failed entering value in to the '${s}' field as the label Not Found.`;break}let g=b.id.replace("_label",""),h=document.getElementById(g),m=h.getAttribute("data-type");switch(m||(m=h.getAttribute("type")),m){case"date":let E=new Date(i.field.value).toISOString().replace(".000Z",".0000000Z");h.value=E;let T=document.getElementById(`${g}_datepicker_description`);T.value=i.field.value;break;case"checkbox":let y=i.field.value.toLocaleLowerCase();h.checked="checked"===y;break;default:h.value=i.field.value}r(h);break;case"select":let w=t[s];if(!w){i.results+=`Failed entering value in to the '${s}' field as the label Not Found.`;break}let v=w.id.replace("_label",""),_=document.getElementById(v),S=!1;if(_.options){for(let e of _.options)if(e.text.toLocaleLowerCase()===i.field.value.toLocaleLowerCase()){_.value=e.value,S=!0;break}}S?r(_):i.results+=`Failed selecting ${i.field.value} value for the '${s}' drop-down field as the specified value not found.`;break;default:let N=e.startsWith("click");if(N){let t=/the (?<elementname>\w+) button/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(console.log(l),0===l.length)return;let n=l[0][0];console.log(`buttonLabel: ${n}`);let a=document.getElementsByTagName("input");for(let e=0;e<a.length;e++){let t=a[e];t.value.toLowerCase()===n&&(t.click(),o=!0)}break}let O=e.startsWith("test step group");if(O){l=i.action;break}let $=e.startsWith("enable");if($){let t=/the (?<elementname>\w+) button/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(console.log(l),0===l.length)return;let n=l[0][0];console.log(`buttonLabel: ${n}`);let o=document.getElementsByTagName("input");for(let e=0;e<o.length;e++){let t=o[e];t.value.toLowerCase()===n&&(t.disabled=!1)}break}let x=e.startsWith("wait");if(x){let t=/for (?<elementname>\w+) seconds/gm,l=[...e.matchAll(t)].map(e=>[e[1]]);if(0===l.length)return;let n=l[0][0];await a(+n)}}""!==i.results?(i.results=`\u26d4 STEP ${i.id} ${i.results} - ${l}`,i.failed=!0):(i.results=`\u2705 STEP ${i.id}: ${i.action} ${i.description?i.description:i.field?`${JSON.stringify(i.field)}`:""}`,i.failed=!1)}if(i.executed=!0,window.opener.postMessage(JSON.stringify(i),"*"),o)break}async function a(e){return new Promise(t=>setTimeout(t,e))}}},{"~constants/task-command":"3Fd9E","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3Fd9E":[function(e,t,l){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(l),n.export(l,"OPEN_NEW_TAB",()=>o),n.export(l,"GET_GITHUB_JSON_FILE_CONTENT",()=>a),n.export(l,"TEST_RESULT",()=>r),n.export(l,"TEST_AGENT_READY_FOR_TEST_STEPS",()=>i),n.export(l,"EXEC_TEST_STEPS",()=>s);let o="open-new-tab",a="get-file-content",r="test-result",i="TEST_AGENT_READY_FOR_TEST_STEPS",s="EXEC_TEST_STEPS"},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(e,t,l){l.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},l.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},l.exportAll=function(e,t){return Object.keys(e).forEach(function(l){"default"===l||"__esModule"===l||t.hasOwnProperty(l)||Object.defineProperty(t,l,{enumerable:!0,get:function(){return e[l]}})}),t},l.export=function(e,t,l){Object.defineProperty(e,t,{enumerable:!0,get:l})}},{}]},["eydOt"],"eydOt","parcelRequire7000"),globalThis.define=t;